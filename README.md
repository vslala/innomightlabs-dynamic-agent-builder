# Innomightlabs Dynamic Agent Builder

Build and deploy AI agents with long-term memory, custom tools, and scalable infrastructure. This repo contains:
- A FastAPI backend for agents, memory, tools, and billing.
- A React (Vite) SPA for the dashboard and landing site.
- Terraform infrastructure + scripts for repeatable deployments.
- An embeddable widget for chat experiences.

The landing page highlights the core product:
- **Long-term memory**: agents remember context across sessions.
- **Custom tools & integrations**: connect agents to external APIs.
- **Dynamic behavior**: adapt responses based on memory and real-time data.
- **Analytics & security**: dashboards, role-based access, and encryption.
- **From idea to production**: define an agent, configure memory, add tools, deploy.

## Repo Layout
- `api/`: FastAPI backend + Lambda handlers.
- `spa/`: React SPA (dashboard + landing page).
- `spa/widget/`: Embeddable widget bundle.
- `terraform/`: Core infrastructure (API, auth, storage, CDN, etc).
- `scripts/`: Deployment helpers and env tooling.

## Local Development

### Prerequisites
- Python 3.13+
- `uv` (Python package manager)
- Node.js + Yarn (for the SPA)
- AWS credentials (for DynamoDB + AWS services)
- Optional: `direnv` for automatic env loading

### 1) Environment setup
This repo uses a **`.envrc`** file to manage environment variables. It defines:
- **Common variables** shared across environments (AWS, Pinecone, OAuth, etc).
- **Environment-specific overrides** using a `{ENV}_VAR_NAME` convention.
- **Local defaults** for development when you’re not deploying.

We also include a **`.env.example`** file as a template for all required variables.

```bash
cp .env.example .envrc
# Fill in real values, then:
direnv allow
```

If you don’t use `direnv`, you can still export variables manually or `source .envrc`.

### 2) Backend (API)
```bash
cd api
uv sync
uv run uvicorn main:app --reload
```

### 3) Frontend (SPA)
```bash
cd spa
yarn install
yarn dev
```

The SPA reads `VITE_*` variables (see `.env.example`). Defaults point to
`http://localhost:8000` if `VITE_API_BASE_URL` is unset.

## Environment Management

### `.envrc` conventions
The env file is structured around **prefix-based overrides**:

- Common: `STRIPE_SECRET_KEY`, `FRONTEND_URL`, `API_DOMAIN`, etc.
- Environment-specific: `DEV_STRIPE_SECRET_KEY`, `UAT_STRIPE_SECRET_KEY`, `PROD_STRIPE_SECRET_KEY`
- Local: `LOCAL_*` variables used for local development

When running locally, `.envrc` sets friendly defaults unless
`SKIP_DEFAULT_ENV=1` is set (deployment scripts set this flag).

### `scripts/generate_tfvars.sh`
This script converts environment variables into Terraform inputs:
- Reads `.envrc`
- Picks `{ENV}_VAR_NAME` if present, otherwise falls back to `VAR_NAME`
- Writes `terraform/terraform.tfvars`

Example:
```
DEV_STRIPE_SECRET_KEY overrides STRIPE_SECRET_KEY when deploying dev
```

Use it directly:
```bash
scripts/generate_tfvars.sh dev
scripts/generate_tfvars.sh uat
scripts/generate_tfvars.sh prod
```

## Deployment

Terraform is the source of truth for infrastructure.
`terraform/terraform.tfvars` is generated by scripts; don’t edit it manually.
Use `terraform/terraform.tfvars.example` as a reference.

### Standard deploy scripts
- `scripts/deploy_dev.sh`
- `scripts/deploy_uat.sh`
- `scripts/deploy_prod.sh`

Each one:
1. Calls `scripts/generate_tfvars.sh`
2. Runs `terraform init` (if needed)
3. Runs `terraform plan`
4. Prompts before `terraform apply`  
   (prod requires a stronger confirmation)

### Local env shortcut
For local development, source:
```bash
source scripts/deploy_local.sh
```
This exports `LOCAL_*` values into the active shell session.

## Notes
- **Secrets live in `.envrc`**: keep them private and avoid committing real values.
- The backend expects some variables like `AWS_REGION_NAME` (see `api/src/config/settings.py`).
- Stripe pricing IDs and other billing settings are required only if billing is enabled.

## Next Steps
- Read `api/README.md` for backend architecture details.
- Inspect `spa/src/pages/LandingPage.tsx` and related components for the marketing copy.

